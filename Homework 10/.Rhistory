for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok&male,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
}
male_avg_death_rate
avg_death_rate
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, male_avg_death_rate/male_avg_death_rate[1], col="blue")
lines(years_1, female_avg_death_rate/female_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, male_avg_death_rate/male_avg_death_rate[1], col="blue")
lines(years_1, female_avg_death_rate/female_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
avg_death_rate/avg_death_rate[1]
male_avg_death_rate/male_avg_death_rate[1]
female_avg_death_rate/female_avg_death_rate[1]
R1 <- data[,"Census.Region.Code"]=="CENS-R1"
R1
data <- nhl
male <- data[,"Gender.Code"]=="M"
R1 <- data[,"Census.Region.Code"]=="CENS-R1"
R2 <- data[,"Census.Region.Code"]=="CENS-R2"
R3 <- data[,"Census.Region.Code"]=="CENS-R3"
R4 <- data[,"Census.Region.Code"]=="CENS-R4"
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R1,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R1,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1])
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1])
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1])
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1])
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
R1_avg_death_rate <- array(NA, length(years_1))
R2_avg_death_rate <- array(NA, length(years_1))
R3_avg_death_rate <- array(NA, length(years_1))
R4_avg_death_rate <- array(NA, length(years_1))
data <- nhl
male <- data[,"Gender.Code"]=="M"
R1 <- data[,"Census.Region.Code"]=="CENS-R1"
R2 <- data[,"Census.Region.Code"]=="CENS-R2"
R3 <- data[,"Census.Region.Code"]=="CENS-R3"
R4 <- data[,"Census.Region.Code"]=="CENS-R4"
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R1,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R1,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1])
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1])
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1])
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1])
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
colors()
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], color="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], color="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], color="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], color="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
#ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
ok <- data[,"Year"]==years_1[i]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R1,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R1,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(2000,2010,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[1]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R1,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R1,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[3]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R1,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R1,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R1,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R1,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[1]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R1,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R1,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[1]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
R1_male_avg_death_rate[i] <- array(NA, length(years_1))
R2_male_avg_death_rate[i] <- array(NA, length(years_1))
R3_male_avg_death_rate[i] <- array(NA, length(years_1))
R4_male_avg_death_rate[i] <- array(NA, length(years_1))
R1_female_avg_death_rate[i] <- array(NA, length(years_1))
R2_female_avg_death_rate[i] <- array(NA, length(years_1))
R3_female_avg_death_rate[i] <- array(NA, length(years_1))
R4_female_avg_death_rate[i] <- array(NA, length(years_1))
R1_male_avg_death_rate <- array(NA, length(years_1))
R2_male_avg_death_rate <- array(NA, length(years_1))
R3_male_avg_death_rate <- array(NA, length(years_1))
R4_male_avg_death_rate <- array(NA, length(years_1))
R1_female_avg_death_rate <- array(NA, length(years_1))
R2_female_avg_death_rate <- array(NA, length(years_1))
R3_female_avg_death_rate <- array(NA, length(years_1))
R4_female_avg_death_rate <- array(NA, length(years_1))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[1]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[3]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[1]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[3]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_avg_death_rate/R1_avg_death_rate[1], col="blue")
lines(years_1, R2_avg_death_rate/R2_avg_death_rate[1], col="red")
lines(years_1, R3_avg_death_rate/R3_avg_death_rate[1], col="green")
lines(years_1, R4_avg_death_rate/R4_avg_death_rate[1], col="orange")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
for (i in 1:length(years_1)){
ok <- data[,"Year"]==years_1[i] & data[,"Single.Year.Ages.Code"] %in% ages_decade[[2]]
avg_death_rate[i] <- mean(data[ok,"Deaths"]/data[ok,"Population"])
male_avg_death_rate[i] <- mean(data[ok&male,"Deaths"]/data[ok&male,"Population"])
female_avg_death_rate[i] <- mean(data[ok&!male,"Deaths"]/data[ok&!male,"Population"])
R1_avg_death_rate[i] <- mean(data[ok&R1,"Deaths"]/data[ok&R1,"Population"])
R2_avg_death_rate[i] <- mean(data[ok&R2,"Deaths"]/data[ok&R2,"Population"])
R3_avg_death_rate[i] <- mean(data[ok&R3,"Deaths"]/data[ok&R3,"Population"])
R4_avg_death_rate[i] <- mean(data[ok&R4,"Deaths"]/data[ok&R4,"Population"])
R1_male_avg_death_rate[i] <- mean(data[ok&R1&male,"Deaths"]/data[ok&R1&male,"Population"])
R2_male_avg_death_rate[i] <- mean(data[ok&R2&male,"Deaths"]/data[ok&R2&male,"Population"])
R3_male_avg_death_rate[i] <- mean(data[ok&R3&male,"Deaths"]/data[ok&R3&male,"Population"])
R4_male_avg_death_rate[i] <- mean(data[ok&R4&male,"Deaths"]/data[ok&R4&male,"Population"])
R1_female_avg_death_rate[i] <- mean(data[ok&R1&!male,"Deaths"]/data[ok&R1&!male,"Population"])
R2_female_avg_death_rate[i] <- mean(data[ok&R2&!male,"Deaths"]/data[ok&R2&!male,"Population"])
R3_female_avg_death_rate[i] <- mean(data[ok&R3&!male,"Deaths"]/data[ok&R3&!male,"Population"])
R4_female_avg_death_rate[i] <- mean(data[ok&R4&!male,"Deaths"]/data[ok&R4&!male,"Population"])
}
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_male_avg_death_rate/R1_male_avg_death_rate[1], col="blue")
lines(years_1, R2_male_avg_death_rate/R2_male_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_male_avg_death_rate/R1_male_avg_death_rate[1], col="blue")
lines(years_1, R1_female_avg_death_rate/R1_female_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R2_male_avg_death_rate/R2_male_avg_death_rate[1], col="blue")
lines(years_1, R2_female_avg_death_rate/R2_female_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R3_male_avg_death_rate/R3_male_avg_death_rate[1], col="blue")
lines(years_1, R3_female_avg_death_rate/R3_female_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R4_male_avg_death_rate/R4_male_avg_death_rate[1], col="blue")
lines(years_1, R4_female_avg_death_rate/R4_female_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R2_male_avg_death_rate/R2_male_avg_death_rate[1], col="blue")
lines(years_1, R2_female_avg_death_rate/R2_female_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
plot(years_1, avg_death_rate/avg_death_rate[1], xaxt="n", yaxt="n", ylim=range(.65,1.25), type="n", bty="n", xaxs="i", yaxs="i", xlab="", ylab=if (j==1) "Relative death rate" else "", main=paste("Age-adj, ", min(ages_decade[[j]]), "-", max(ages_decade[[j]]), sep=""))
lines(years_1, R1_male_avg_death_rate/R1_male_avg_death_rate[1], col="blue")
lines(years_1, R1_female_avg_death_rate/R1_female_avg_death_rate[1], col="red")
axis(1, seq(1990,2020,5))
axis(2, seq(.6,1.2,.2))
nhl
head(nhl)
L3 <- LETTERS[1:3]
fac <- sample(L3, 10, replace = TRUE)
(d <- data.frame(x = 1, y = 1:10, fac = fac))
nhl
head(nhl)
age <- nhl$Single.Year.Ages.Code
typeof(age)
mean(data[ok,"Deaths"]/data[ok,"Population"])
mean(data[ok,"Rate"])
mean(data[ok,"Crude.Rate"])
data[ok,"Crude.Rate"]
as.numeric(data[ok,"Crude.Rate"])
data[ok,"Crude.Rate"][1]
as.numeric(data[ok,"Crude.Rate"])[1]
as.integer(data[ok,"Crude.Rate"])[1]
as.integer(data[ok,"Crude.Rate"][1])
data[,"Crude.Rate"]
data[,"Deaths"]
age <- nhl$Single.Year.Ages.Code
year <- nhl$Year.Code
gender <- nhl$Gender.Code
region <- nhl$Census.Region.Code
deaths <- nhl$Deaths
population <- nhl$Population
mort_data <- data.frame(age, year, gender, region, deaths, population)
mort_data
head(mort_data)
is.factor(hsb2$gender)
is.factor(mort_data$gender)
mort_data$year <- as.factor(year)
as.numeric(gender)
as.numeric(gender) - 1
C(region, treatment)
male <- gender=="M"
male
male <- gender=="M"
female <- gender=="F"
R1 <- region=="CENS-R1"
R2 <- region=="CENS-R2"
R3 <- region=="CENS-R3"
R4 <- region=="CENS-R4"
fit("linear_model.stan")
library(rstan)
fit("linear_model.stan")
stan("linear_model.stan")
N <- length(gender)
N
stan("linear_model.stan")
stan("linear_model.stan")
stan("linear_model.stan")
stan("linear_model.stan")
stan("linear_model.stan")
stan("linear_model.stan")
deaths
deaths/population
stan("linear_model.stan")
age
year
year <- year - 1999
plot(age, deaths)
plot(log(age), deaths)
plot(age, log(deaths))
year <- factor(year)
year
lm(deaths ~ year)
stan("linear_model.stan")
stan("linear_model.stan")
library(rstan)
